<!DOCTYPE html><html lang="en"> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.15.4"><!-- Canonical URL --><link rel="canonical" href="https://ocavue.com/posts/yarn-2-first-impression-en/"><!-- Primary Meta Tags --><title>Ocavue</title><meta name="title" content="Ocavue"><meta name="description" content="Ocavue's Portfolio"><!-- Open Graph / Facebook --><meta property="og:type" content="website"><meta property="og:url" content="https://ocavue.com/posts/yarn-2-first-impression-en/"><meta property="og:title" content="Ocavue"><meta property="og:description" content="Ocavue's Portfolio"><meta property="og:image" content="https://ocavue.com/preview.png"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://ocavue.com/posts/yarn-2-first-impression-en/"><meta property="twitter:title" content="Ocavue"><meta property="twitter:description" content="Ocavue's Portfolio"><meta property="twitter:image" content="https://ocavue.com/preview.png"><script>
"use strict";(()=>{(()=>{let t="theme-toggle";function o(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function l(){let e=localStorage.getItem(t);return e==="dark"||e==="light"?e:null}function n(){return l()||o()}function c(e){e===o()?localStorage.removeItem(t):localStorage.setItem(t,e)}function s(e){let m=document.documentElement;m.classList.toggle("dark",e==="dark"),m.style.colorScheme=e}function r(e){c(e),s(e)}r(n()),window.astroThemeToggle={setTheme:r,getTheme:n}})();})();
</script><link rel="stylesheet" href="/_astro/index.SEaj0x-w.css">
<style>::view-transition-old(root),::view-transition-new(root){animation:none;mix-blend-mode:normal}
</style><script type="module">function m(){return typeof window>"u"?"light":window.astroThemeToggle?.getTheme?.()||"light"}function c(e){typeof window>"u"||window.astroThemeToggle?.setTheme?.(e)}function l(){const e=m();c(e==="light"?"dark":"light")}async function h(e,t,n){const o=document;if(typeof o.startViewTransition!="function"){e();return}await o.startViewTransition(()=>{e()})?.ready;const a=.7,r=`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 8"><defs><radialGradient id="toggle-theme-gradient"><stop offset="${a}"/><stop offset="1" stop-opacity="0"/></radialGradient></defs><circle cx="4" cy="4" r="4" fill="url(#toggle-theme-gradient)"/></svg>`,s=`data:image/svg+xml;base64,${window.btoa(r)}`,d=window.innerWidth,g=window.innerHeight,i=Math.ceil(Math.hypot(Math.max(t,d-t),Math.max(n,g-n))/a);document.documentElement.animate({maskImage:[`url('${s}')`,`url('${s}')`],maskRepeat:["no-repeat","no-repeat"],maskPosition:[`${t}px ${n}px`,`${t-i}px ${n-i}px`],maskSize:["0",`${2*i}px`]},{duration:500,easing:"ease-in",pseudoElement:"::view-transition-new(root)"})}function w(e){h(l,e.clientX,e.clientY)}document.getElementById("theme-toggle")?.addEventListener("click",w);
</script>
<script type="module" src="/_astro/page.7qqag-5g.js"></script></head> <body> <header> <nav class="py-8 flex items-center text-xl max-w-screen-md mx-auto px-4"> <a href="/" title="Home" class="flex items-center"> <img src="/favicon.svg" alt="Ocavue" class="size-10"> </a> <span class="flex-1"></span> <span class="flex gap-5"> <a href="/posts" title="Blog" class="inline-flex opacity-50 hover:opacity-100 transition-opacity items-center"> <span>Blog</span> </a> <a href="/chat" title="Chat" class="inline-flex opacity-50 hover:opacity-100 transition-opacity items-center"> <span>Chat</span> </a> <a href="/talks" title="Talks" class="inline-flex opacity-50 hover:opacity-100 transition-opacity items-center"> <span>Talks</span> </a> <a href="https://twitter.com/ocavue" title="Twitter" class="inline-flex opacity-50 hover:opacity-100 transition-opacity items-center" target="_blank"> <span class="i-ph:x-logo size-6 block"></span> </a> <a href="https://github.com/ocavue" title="GitHub" class="inline-flex opacity-50 hover:opacity-100 transition-opacity items-center" target="_blank"> <span class="i-ph:github-logo size-6 block"></span> </a> <button class="inline-flex opacity-50 hover:opacity-100 transition-opacity items-center" id="theme-toggle"><span class="i-ph-sun dark:i-ph-moon size-6 min-w-6 min-h-6 block"></span></button> </span> </nav> </header>  <main class="text-base dark:prose-invert prose prose-truegray max-w-screen-md mx-auto px-4 py-12">  <article> <h1>Yarn 2 first impression</h1> <span class="opacity-50 text-base"> <time datetime="2020-12-25T00:00:00.000Z"> Dec 25, 2020 </time> </span> <div class="pt-10"> <p>Yarn is a very popular package management tool for the JavaScript community. On 2020-01-24, Yarn 2 <a href="https://dev.to/arcanis/introducing-yarn-2-4eh1">was officially released</a>. After observing it for a while, I have upgraded several of my projects to Yarn 2 since last month. In this post, I will briefly describe my experience with Yarn 2 over the past month.</p>
<p><em>Note: This is not a Yarn 2 tutorial, and I will not go into detail about every feature of Yarn 2. If you want to learn more about Yarn 2, check out the <a href="https://yarnpkg.com/">official documentation</a> for Yarn 2.</em></p>
<h2 id="plugnplay">Plug’n’Play</h2>
<p>Without a doubt, the best feature of Yarn 2 is its Plug’n’Play system (hereafter referred to as PnP). While Yarn 1 can also use PnP, Yarn 2 has it turned on by default.</p>
<!-- PnP 如何解决这个问题 -->
<p><code>node_modules</code> is one of the most widely criticized aspects of Node.js. Yarn PnP is one of the community’s attempts to replace <code>node_modules</code>. After the first installation of dependencies, Yarn 2 creates a <code>.pnp.js</code> file in addition to <code>yarn.lock</code>. With this file, Yarn can proactively tell Node.js where a specific dependency should be found, rather than letting Node.js try to find the dependency in the <code>node_modules</code> directory on its own. In this way, Yarn can store all packages in a zip format, or even have different projects share the same dependency file, thus reducing the size and loading time of dependencies. From my experience, Yarn PnP is really fast and amazing.</p>
<!-- PnP 带来了什么额外的问题 -->
<p>However, almost all of the current Node.js community tools are based on <code>node_modules</code>. This causes Yarn PnP to be incompatible with many current tools, such as code editors. If your editor cannot resolve dependencies, then you need to take extra steps, which include adding extra files to your VCS, as well as manually configuring your editor, or even installing extra editor plugins. Not to mention, as of today, Yarn only supports VSCode and Vim.</p>
<!-- 我的选择是什么 -->
<p>Because of these shortcomings, I went back to the <code>node_modules</code> model (by adding <code>nodeLinker: node-modules</code> to <code>.yarnrc.yml</code>). Although given the speed of Yarn PnP, PnP is great, but I don’t think the world is ready for it yet.</p>
<h2 id="yarnlock-and-yarn-deque">yarn.lock and yarn deque</h2>
<p>One of the biggest problems with Yarn 1 is the problem of duplicate and outdated dependency versions in <code>yarn.lock</code>. This problem used to cause some very puzzling phenomena. In the past, I have to use <a href="https://github.com/atlassian/yarn-deduplicate"><code>yarn-deduplicate</code></a> from Atlassian to fix this problem. Yarn 2 has native support for the <code>yarn deque</code> command, which has solved this problem at the root.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Overall, Yarn 2 is quite satisfying. I will continue to use Yarn 2 in a few of my large projects and keep watching.</p> </div> </article>  </main> <footer class="pt-10 pb-32 flex items-center justify-center max-w-screen-md mx-auto px-4"> <span class="opacity-50 text-md"> <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" class="hover:underline">CC BY-NC-SA 4.0</a>
2018-2025 &copy; Ocavue
</span> </footer> </body></html>